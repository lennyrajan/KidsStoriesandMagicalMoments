<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kids Stories and Magical Moments</title>
  <meta name="description" content="Watch magical short stories for kids from YouTube. A sweet blend of kindness, imagination, and bedtime joy!" />
  <meta name="keywords" content="kids stories, bedtime stories, YouTube shorts, magical moments" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
</head>

  <body id="body" class="transition-colors duration-1000 text-gray-800 min-h-screen">
  
    <header class="text-center py-8">
    <h1 class="text-4xl font-bold">Kids Stories and Magical Moments</h1>
    <p class="text-lg mt-2">Enchanting short stories for little hearts üí´</p>
  </header>

  <main class="px-4 md:px-16">
    <div id="videoGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6"></div>
  </main>

<!-- Modal -->
<div id="videoModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4">
  <div class="relative w-full max-w-sm sm:max-w-md md:max-w-lg" style="aspect-ratio: 9 / 16;">
    <iframe
      id="modalIframe"
      class="w-full h-full rounded-xl shadow-xl"
      frameborder="0"
      allow="autoplay; encrypted-media"
      allowfullscreen
    ></iframe>
    <button
      onclick="closeModal()"
      class="absolute -top-3 -right-3 bg-white text-black p-2 rounded-full shadow"
      aria-label="Close video"
    >‚ùå</button>
  </div>
</div>
  
  <script>
    async function fetchVideos() {
      try {
        const res = await fetch("/.netlify/functions/fetchVideos");
        const data = await res.json();

        const grid = document.getElementById("videoGrid");
        grid.innerHTML = "";

        data.forEach(video => {
          const id = video.id?.videoId;
          const title = video.snippet?.title || "Untitled";
          const thumb = video.snippet?.thumbnails?.medium?.url || "";

          if (!id || !thumb) return;

          const div = document.createElement("div");
          div.className = "bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl transition duration-300 cursor-pointer";
          div.innerHTML = `
            <img src="${thumb}" alt="${title}" class="w-full">
            <div class="p-4">
              <h2 class="text-md font-semibold">${title}</h2>
            </div>
          `;

          div.onclick = () => openModal(id);
          grid.appendChild(div);
        });
      } catch (err) {
        console.error("Failed to load videos:", err);
      }
    }

    function openModal(videoId) {
      const modal = document.getElementById("videoModal");
      const iframe = document.getElementById("modalIframe");
      iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
      modal.classList.remove("hidden");
    }

    function closeModal() {
      const modal = document.getElementById("videoModal");
      const iframe = document.getElementById("modalIframe");
      iframe.src = "";
      modal.classList.add("hidden");
    }

    window.onload = fetchVideos;
  </script>

</body>
</html>
